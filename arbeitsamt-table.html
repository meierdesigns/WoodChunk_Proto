<!-- Arbeitsamt-Tabelle - Externe Datei -->
<div class="button-section">
  <table class="arbeitsamt-table-external">
    <thead>
      <tr>
        <th style="text-align: left;">Beruf</th>
        <th>Anzahl</th>
        <th>Aktion</th>
        <th>Werkzeug</th>
      </tr>
    </thead>
    <tbody id="job-rows-container">
      <!-- Fallback job rows in case component fails -->
      <tr class="job-row" data-job-type="Worker">
        <td>
          <div class="job-display">
            <div class="job-icon-shield">
              <span class="job-icon">ðŸª“</span>
            </div>
            <span class="job-name">HolzfÃ¤ller</span>
          </div>
        </td>
        <td>
          <span id="workerCount">0</span>
        </td>
        <td>
          <div class="action-controls">
            <button id="decreaseWorkerCount" onclick="decreaseWorkerCount()" disabled>-</button>
            <button id="increaseWorkerCount" onclick="increaseWorkerCount()">+</button>
          </div>
        </td>
        <td>
          <span class="tool-level">Lv. <span id="toolLevelWorker">1</span></span>
          <button id="upgradeWorkerToolButton" onclick="testUpgradeTool()" title="Axt verbessern">
            <span class="icon">ðŸª“</span> <span id="toolCostWorker">50</span><span class="icon">ðŸ’°</span>
          </button>
        </td>
      </tr>
      <tr class="job-row" data-job-type="Forester">
        <td>
          <div class="job-display">
            <div class="job-icon-shield">
              <span class="job-icon">ðŸŒ±</span>
            </div>
            <span class="job-name">FÃ¶rster</span>
          </div>
        </td>
        <td>
          <span id="foresterCount">0</span>
        </td>
        <td>
          <div class="action-controls">
            <button id="decreaseForesterCount" onclick="decreaseForesterCount()" disabled>-</button>
            <button id="increaseForesterCount" onclick="increaseForesterCount()">+</button>
          </div>
        </td>
        <td>
          <span class="tool-level">Lv. <span id="toolLevelForester">1</span></span>
          <button id="upgradeForesterToolButton" onclick="testUpgradePlantTool()" title="Pflanzwerkzeug verbessern">
            <span class="icon">ðŸŒ¿</span> <span id="toolCostForester">50</span><span class="icon">ðŸ’°</span>
          </button>
        </td>
      </tr>
      <tr class="job-row" data-job-type="Carpenter">
        <td>
          <div class="job-display">
            <div class="job-icon-shield">
              <span class="job-icon">ðŸª‘</span>
            </div>
            <span class="job-name">Schreiner</span>
          </div>
        </td>
        <td>
          <span id="carpenterCount">0</span>
        </td>
        <td>
          <div class="action-controls">
            <button id="decreaseCarpenterCount" onclick="decreaseCarpenterCount()" disabled>-</button>
            <button id="increaseCarpenterCount" onclick="increaseCarpenterCount()">+</button>
          </div>
        </td>
        <td>
          <span class="tool-level">Lv. <span id="toolLevelCarpenter">1</span></span>
          <button id="upgradeCarpenterToolButton" onclick="testUpgradeCarpenterTool()" title="Schreinerwerkzeug verbessern">
            <span class="icon">ðŸ”¨</span> <span id="toolCostCarpenter">50</span><span class="icon">ðŸ’°</span>
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<script>
// Define functions first, before any HTML rendering
window.testUpgradeTool = function() {
  console.log("=== DIRECT TEST: UPGRADE TOOL CLICKED ===");
  console.log("Window variables:", {
    gold: window.gold,
    toolLevel: window.toolLevel
  });
  
  if (window.gold && window.toolLevel) {
    const cost = window.toolLevel * 50;
    console.log("Calculated cost:", cost);
    
    if (window.gold >= cost) {
      console.log("Enough gold, proceeding with upgrade");
      window.gold -= cost;
      window.toolLevel++;
      console.log("After upgrade - gold:", window.gold, "toolLevel:", window.toolLevel);
      
      // Lokale Variablen in index.html aktualisieren
      if (window.updateLocalVariables) {
        window.updateLocalVariables();
      }
      
      if (window.updateDisplay) {
        window.updateDisplay();
      }
      console.log("Tool upgraded to level:", window.toolLevel);
    } else {
      console.log("Not enough gold! Need:", cost, "Have:", window.gold);
    }
  } else {
    console.log("Window variables not available!");
  }
}

window.testUpgradePlantTool = function() {
  console.log("=== DIRECT TEST: UPGRADE PLANT TOOL CLICKED ===");
  console.log("Window variables:", {
    gold: window.gold,
    plantToolLevel: window.plantToolLevel
  });
  
  if (window.gold && window.plantToolLevel) {
    const cost = window.plantToolLevel * 50;
    console.log("Calculated cost:", cost);
    
    if (window.gold >= cost) {
      console.log("Enough gold, proceeding with upgrade");
      window.gold -= cost;
      window.plantToolLevel++;
      console.log("After upgrade - gold:", window.gold, "plantToolLevel:", window.plantToolLevel);
      
      // Lokale Variablen in index.html aktualisieren
      if (window.updateLocalVariables) {
        window.updateLocalVariables();
      }
      
      if (window.updateDisplay) {
        window.updateDisplay();
      }
      console.log("Plant tool upgraded to level:", window.plantToolLevel);
    } else {
      console.log("Not enough gold! Need:", cost, "Have:", window.gold);
    }
  } else {
    console.log("Window variables not available!");
  }
}

window.testUpgradeCarpenterTool = function() {
  console.log("=== DIRECT TEST: UPGRADE CARPENTER TOOL CLICKED ===");
  console.log("Window variables:", {
    gold: window.gold,
    carpenterToolLevel: window.carpenterToolLevel
  });
  
  if (window.gold && window.carpenterToolLevel) {
    const cost = window.carpenterToolLevel * 50;
    console.log("Calculated cost:", cost);
    
    if (window.gold >= cost) {
      console.log("Enough gold, proceeding with upgrade");
      window.gold -= cost;
      window.carpenterToolLevel++;
      console.log("After upgrade - gold:", window.gold, "carpenterToolLevel:", window.carpenterToolLevel);
      
      // Lokale Variablen in index.html aktualisieren
      if (window.updateLocalVariables) {
        window.updateLocalVariables();
      }
      
      if (window.updateDisplay) {
        window.updateDisplay();
      }
      console.log("Carpenter tool upgraded to level:", window.carpenterToolLevel);
    } else {
      console.log("Not enough gold! Need:", cost, "Have:", window.gold);
    }
  } else {
    console.log("Window variables not available!");
  }
}

// Simple inline template for now
const jobRowTemplate = `
<tr class="job-row" data-job-type="{jobType}">
  <td>
    <div class="job-display">
      <div class="job-icon-shield">
        <span class="job-icon">{jobIcon}</span>
      </div>
      <span class="job-name">{jobName}</span>
    </div>
  </td>
  <td>
    <span id="{jobType}Count">{count}</span>
  </td>
  <td>
    <div class="action-controls">
      <button id="decrease{jobType}Count" onclick="decrease{jobType}Count()" disabled>-</button>
      <button id="increase{jobType}Count" onclick="increase{jobType}Count()">+</button>
    </div>
  </td>
  <td>
    <button id="upgrade{jobType}ToolButton" onclick="testUpgrade{jobType}Tool()" title="{toolName} verbessern">
      <span class="icon">{toolIcon}</span> Lv. <span id="toolLevel{jobType}">{toolLevel}</span> 
      (<span id="toolCost{jobType}">{toolCost}</span><span class="icon">ðŸ’°</span>)
    </button>
  </td>
</tr>
`;

// Job data configuration
const jobConfigs = [
  {
    jobType: 'Worker',
    jobIcon: 'ðŸª“',
    jobName: 'HolzfÃ¤ller',
    toolName: 'Axt',
    toolIcon: 'ðŸª“',
    count: 0,
    toolLevel: 1,
    toolCost: 50
  },
  {
    jobType: 'Forester',
    jobIcon: 'ðŸŒ±',
    jobName: 'FÃ¶rster',
    toolName: 'Pflanzwerkzeug',
    toolIcon: 'ðŸŒ¿',
    count: 0,
    toolLevel: 1,
    toolCost: 50
  },
  {
    jobType: 'Carpenter',
    jobIcon: 'ðŸª‘',
    jobName: 'Schreiner',
    toolName: 'Schreinerwerkzeug',
    toolIcon: 'ðŸ”¨',
    count: 0,
    toolLevel: 1,
    toolCost: 50
  }
];

// Simple render function
function renderJobRow(jobData) {
  let html = jobRowTemplate;
  
  // Replace placeholders with actual data
  const replacements = {
    '{jobType}': jobData.jobType,
    '{jobIcon}': jobData.jobIcon,
    '{jobName}': jobData.jobName,
    '{count}': jobData.count || 0,
    '{toolName}': jobData.toolName,
    '{toolIcon}': jobData.toolIcon,
    '{toolLevel}': jobData.toolLevel || 1,
    '{toolCost}': jobData.toolCost || 50
  };

  Object.entries(replacements).forEach(([placeholder, value]) => {
    html = html.replace(new RegExp(placeholder, 'g'), value);
  });

  return html;
}

// Render all job rows
function renderJobRows() {
  const container = document.getElementById('job-rows-container');
  if (!container) {
    console.error('Job rows container not found');
    return;
  }
  
  console.log('Rendering job rows...');
  container.innerHTML = '';
  
  jobConfigs.forEach(jobConfig => {
    const jobRowHtml = renderJobRow(jobConfig);
    container.insertAdjacentHTML('beforeend', jobRowHtml);
  });
  
  console.log('Job rows rendered');
}

// Initialize when DOM is ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', renderJobRows);
} else {
  renderJobRows();
}

// Debug: Check if functions are available
console.log('Functions available:', {
  testUpgradeTool: typeof window.testUpgradeTool,
  testUpgradePlantTool: typeof window.testUpgradePlantTool,
  testUpgradeCarpenterTool: typeof window.testUpgradeCarpenterTool
});

// Test function availability after a delay
setTimeout(() => {
  console.log('Delayed function check:', {
    testUpgradeTool: typeof window.testUpgradeTool,
    testUpgradePlantTool: typeof window.testUpgradePlantTool,
    testUpgradeCarpenterTool: typeof window.testUpgradeCarpenterTool
  });
}, 1000);
</script>

<script>
window.testHireWorker = function() {
  console.log("=== DIRECT TEST: HIRE WORKER CLICKED ===");
  console.log("Window variables:", {
    gold: window.gold,
    workers: window.workers,
    workerBaseCost: window.workerBaseCost
  });
  
  if (window.gold && window.workers && window.workerBaseCost && window.calculateWorkerPrice) {
    const price = window.calculateWorkerPrice(window.workerBaseCost, window.workers - 1);
    console.log("Calculated price:", price);
    
    if (window.gold >= price) {
      console.log("Enough gold, proceeding with hire");
      window.gold -= price;
      window.workers++;
      console.log("After hire - gold:", window.gold, "workers:", window.workers);
      
      // Lokale Variablen in index.html aktualisieren
      if (window.updateLocalVariables) {
        window.updateLocalVariables();
      }
      
      if (window.updateDisplay) {
        window.updateDisplay();
      }
      console.log("Worker hired, total workers:", window.workers);
    } else {
      console.log("Not enough gold! Need:", price, "Have:", window.gold);
    }
  } else {
    console.log("Window variables not available!");
  }
}

window.testHireForester = function() {
  console.log("=== DIRECT TEST: HIRE FORESTER CLICKED ===");
  console.log("Window variables:", {
    gold: window.gold,
    foresters: window.foresters,
    foresterBaseCost: window.foresterBaseCost
  });
  
  if (window.gold && window.foresters && window.foresterBaseCost && window.calculateWorkerPrice) {
    const price = window.calculateWorkerPrice(window.foresterBaseCost, window.foresters - 1);
    console.log("Calculated price:", price);
    
    if (window.gold >= price) {
      console.log("Enough gold, proceeding with hire");
      window.gold -= price;
      window.foresters++;
      console.log("After hire - gold:", window.gold, "foresters:", window.foresters);
      
      // Lokale Variablen in index.html aktualisieren
      if (window.updateLocalVariables) {
        window.updateLocalVariables();
      }
      
      if (window.updateDisplay) {
        window.updateDisplay();
      }
      console.log("Forester hired, total foresters:", window.foresters);
    } else {
      console.log("Not enough gold! Need:", price, "Have:", window.gold);
    }
  } else {
    console.log("Window variables not available!");
  }
}

window.testHireCarpenter = function() {
  console.log("=== DIRECT TEST: HIRE CARPENTER CLICKED ===");
  console.log("Window variables:", {
    gold: window.gold,
    carpenters: window.carpenters,
    carpenterBaseCost: window.carpenterBaseCost
  });
  
  if (window.gold && window.carpenters !== undefined && window.carpenterBaseCost && window.calculateWorkerPrice) {
    const price = window.calculateWorkerPrice(window.carpenterBaseCost, window.carpenters);
    console.log("Calculated price:", price);
    
    if (window.gold >= price) {
      console.log("Enough gold, proceeding with hire");
      window.gold -= price;
      window.carpenters++;
      console.log("After hire - gold:", window.gold, "carpenters:", window.carpenters);
      
      // Lokale Variablen in index.html aktualisieren
      if (window.updateLocalVariables) {
        window.updateLocalVariables();
      }
      
      if (window.updateDisplay) {
        window.updateDisplay();
      }
      console.log("Carpenter hired, total carpenters:", window.carpenters);
    } else {
      console.log("Not enough gold! Need:", price, "Have:", window.gold);
    }
  } else {
    console.log("Window variables not available!");
  }
}

// Count control functions
window.increaseWorkerCount = function() {
  if (window.gameCore) {
    window.gameCore.increaseWorkerCount('workers');
  }
}

window.decreaseWorkerCount = function() {
  if (window.gameCore) {
    window.gameCore.decreaseWorkerCount('workers');
  }
}

window.increaseForesterCount = function() {
  if (window.gameCore) {
    window.gameCore.increaseWorkerCount('foresters');
  }
}

window.decreaseForesterCount = function() {
  if (window.gameCore) {
    window.gameCore.decreaseWorkerCount('foresters');
  }
}

window.increaseCarpenterCount = function() {
  if (window.gameCore) {
    window.gameCore.increaseWorkerCount('carpenters');
  }
}

window.decreaseCarpenterCount = function() {
  if (window.gameCore) {
    window.gameCore.decreaseWorkerCount('carpenters');
  }
}
</script> 